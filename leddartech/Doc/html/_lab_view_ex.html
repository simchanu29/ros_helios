<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Leddar™ SDK: LabVIEW&trade; Integration Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="d-tec_04.ico"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Leddar™ SDK
   &#160;<span id="projectnumber">2.10.0.92</span>
   </div>
   <div id="projectbrief">Programmer&#39;s interface to Leddar™ sensors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LabVIEW&trade; Integration Example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="LVIntro"></a>
Introduction</h1>
<p>In a wish to ease the integration of its Leddar&trade; technology for its customers, LeddarTech has created as set of functionalities enabling fast development for application engineers. Using the Microsoft .NET platform, it is easy to connect to a sensor, obtain its measurements and process them at your leisure. The Leddar&trade; .NET SDK is event-driven, meaning each time new data arrives from the sensor, a <code> DataReceived </code> event is thrown and the system automatically calls your chosen data processing function. You can directly write this event-processing function, but in the following examples, the event queue is abstracted by a data reading function which will always return the most up-to-date sensor information.</p>
<h1><a class="anchor" id="LVDesc"></a>
Description and usage</h1>
<p>LabVIEW&trade; offers integration of the .NET framework in its environment. LeddarTech has built a high level example integration of these .NET functions in only a few building blocks (VI):</p>
<ul>
<li>Open a connection to a Leddar&trade; sensor</li>
<li>Obtain and process its data</li>
<li>Close the connection</li>
</ul>
<p>To insert the Leddar&trade; .NET control to a VI front panel:</p>
<ul>
<li>Right click on the front panel and select <code>.NET &amp; ActiveX</code> menu</li>
<li>Add a .NET container to your form</li>
<li>Right click on your container and select the <code>Insert .NET Control...</code> menu</li>
<li>Browse for the LeddarNET2.dll and select the <code>DeviceControl</code> control</li>
</ul>
<p>Now in the block diagram, you can wire your control to a LabVIEW&trade; Property Node. To access the tool blocks required for a .NET object, right click the block diagram window and select the Connectivity menu. Go to the .NET palette to choose your functions. After connecting the Property Node, select the <code>TheDevice</code> property. It is the reference to the actual device linked to the Leddar&trade; control. This device has all the required methods to manipulate your sensor. To access them, include an <code>Invoke Node</code> to your diagram. To register a function to process incoming data from the sensor, add a Register Event Callback block. Wire its event source input to the device and select the <code>DataReceived</code> event if not already selected. Right click the VI Reference input. Select Create Callback VI to let LabVIEW&trade; create for you the VI with a matching signature for the event. Inside this VI, you can call the <code>Detections</code> method of the event source to obtain the data and process it. The remaining of this page will describe an example implementation to help you getting started using Leddar&trade; technology in LabVIEW&trade;.</p>
<h2><a class="anchor" id="CCVI"></a>
Leddar2LabVIEW Control Center VI</h2>
<p>This interface (Leddar2LabVIEW.vi) allows the user to input its Leddar&trade; sensor address as a USB device name or a recorded device session. After choosing the appropriate connection mode using the radio buttons, the user can hit the CONNECT button to start. If the device cannot open, a message box appears. Otherwise the button becomes green indicating a successful connection and is disabled until the connection closes. In the case of a USB connection, you can obtain the list of connected device names using the main Leddar&trade;Configuration Software coming with your sensor. The Read VI is called in a loop until either the user hits the DISCONNECT button or no new data is available. For each call, detections are transferred to the plot &amp; process sub-VI.</p>
<h2><a class="anchor" id="LOVI"></a>
LeddarOpen sub-VI</h2>
<p>The OPEN sub-VI prepares the system to receive data from the sensor. It takes as input the connection string (file path or USB device name) and dispatches it to the proper .NET function according to the input connection mode. The functions used are <code>Connect</code> (for USB) and <code>LoadRecord</code> to open a recorded *.ltl file. On a successful open, <code>StartDataTransfer</code> is called and the DataReceived_CB VI is registered as a listener for the <code>DataReceived</code> event.</p>
<h2><a class="anchor" id="DRC"></a>
DataReceived Callback</h2>
<p>On reception of new data, the <code>DataReceived</code> event is thrown and the VI executes. Its task is quite simple here. It forwards the array of detections from the device to a global variable accessible to the Read VI. It also sets a flag indicating that new data is available. In another kind of implementation, one could directly put its processing blocks inside this VI. Each time new data arrives, the function will automatically execute itself.</p>
<h2><a class="anchor" id="LRVI"></a>
LeddarRead sub-VI</h2>
<p>This function returns a new detection array each time it is called. It starts by moving to the chosen frame index in the case of a file connection. Then it waits for the <code>DataReceived</code> event to complete by checking the NEW status. When new data arrives, the global detections variable is read and returned. If no NEW status is set within a timeout of a few seconds, the while loop stops and FALSE is returned as the NEW status.</p>
<h2><a class="anchor" id="LCVI"></a>
LeddarClose sub-VI</h2>
<p>After the user has finished processing data from the device, the connection can be closed. We first unregister our callback function from the <code>DataReceived</code> event. Parallel to this, the data transfer can be stopped and the sensor disconnected.</p>
<h2><a class="anchor" id="DDVI"></a>
Detections Display sub-VI</h2>
<p>The result of Read VI is sent directly to the detection viewer function. It starts by computing the angular mapping of each segments considering a 45&deg; sensor with 16 equally spaced segments. Then the input detections are stored into their vectors of segments and distances before converting them into X-Y coordinates ready to be plotted onto the graph.</p>
<h2><a class="anchor" id="SEVI"></a>
SingleExecution VI</h2>
<p>Quite often it is useful in LabVIEW&trade; to have a single-shot driver implementing an all-in-one package connecting to a device, getting one data packet and closing the connection. This VI has been designed specifically to demonstrate this usage. The user of this VI must first fill the required connection data:</p>
<ul>
<li>Path to file or USB device name</li>
<li>Frame index if in file connection</li>
<li>Connection mode (file or USB)</li>
</ul>
<p>Then simply hit the LabVIEW&trade; Run button. This will update the FanGraph.vi.</p>
<dl class="section note"><dt>Note</dt><dd>The first time you open this example, LabVIEW&trade; will search for the LeddarNET2.dll. If you installed in the default directory, it should be able to find it by itself. Otherwise simply browse to the proper location. LabVIEW&trade; may warn you that the version number is not the same as what is saved in the project; you can ignore this warning. </dd>
<dd>
This example was written and tested with LabVIEW&trade; 2012. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 7 2014 15:36:01 for Leddar™ SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
